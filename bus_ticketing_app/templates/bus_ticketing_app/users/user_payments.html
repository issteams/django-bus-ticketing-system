{% extends 'bus_ticketing_app/users/user_layout.html' %}
{% load static %}

{% block title %} Payment Details {% endblock title %}

{% block custom_css %}
<style>
  .payment-content {
    min-height: 100vh;
    padding: 50px;
  }
  .overlay {
    background-color: rgba(255, 255, 255, 0.7);
    padding: 30px;
    border-radius: 15px;
  }
  .message {
    font-size: 1.5em;
    text-align: center;
    margin-top: 20px;
  }
  .payment-table {
    width: 100%;
    margin-top: 20px;
  }
  .payment-table th, .payment-table td {
    padding: 15px;
    text-align: left;
  }
  .payment-table th {
    background-color: green;
    color: white;
  }
  .payment-table td {
    background-color: rgba(255, 255, 255, 0.1);
  }
  .pay-btn, .view-btn {
    background-color: #28a745;
    border: none;
    color: white;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 5px;
  }
  .view-btn {
    background-color: gray;
  }
</style>
{% endblock custom_css %}

{% block body %}
<div class="payment-content">
  <div class="overlay">
    {% if message %}
      <div class="message">{{ message }}</div>
    {% else %}
      <h1 class="text-center">Payment Details</h1>
      <div class="table-responsive">
        <table class="payment-table">
          <thead>
            <tr>
              <th>Passenger</th>
              <th>Schedule</th>
              <th>Amount</th>
              <th>Payment Date</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for payment in payments %}
              <tr>
                <td>{{ payment.passenger_id.admin.username }}</td>
                <td>{{ payment.schedule_id.route_id.origin }} to {{ payment.schedule_id.route_id.destination }}</td>
                <td>${{ payment.amount }}</td>
                <td>{{ payment.payment_date }}</td>
                <td>{{ payment.payment_status }}</td>
                <td>
                  {% if payment.payment_status == 'pending' %}
                    <a href="{% url 'bus_ticketing_app:make_payment' payment.id %}" class="pay-btn">Make Payment</a>
                  {% elif payment.payment_status == 'success' %}
                    <button class="view-btn" disabled>Paid</button>
                  {% elif payment.payment_status == 'failed' %}
                    <button class="view-btn" disabled>Failed</button>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% endif %}
  </div>
</div>
{% endblock body %}
